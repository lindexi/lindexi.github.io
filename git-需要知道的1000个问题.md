
# git 需要知道的1000个问题


<!--more-->


<div id="toc"></div>
<!-- csdn -->

## 计算 git 的提交数

使用下面代码可以计算提交数

```csharp
git rev-list --all --count
```

## 提交出现 TaskCanceledException

如果提交出现异常 `Fatal: TaskCanceledException encountered`

这是 git 的问题，尝试升级最新的 git 或输入`git config --global credential.helper wincred` 就可以让 git 记住密码

## Cherry-pick 多个提交

如果多个提交是连续的，那么可以使用下面的方法`git cherry-pick 开始...结束`

例如有提交

76a0298d38760a635f404c1660238ae852d96517 提交 4

55b43be69fa90f4d03f27632c0231458ba1e7fd9 提交 3 

55b43be69fa90f4d03f27632c0231458ba1e7fd9 错误的提交

e50b523f12d34435b3b49fe229d76ecc4754687f 提交 2

322d49c166b0a48bdcc6c1f69b29c617b435850b 提交 1

8793f59a87cbc4c62cf77b21369de657dc343a5d 提交 0


需要挑拣出 提交0-4 那么一般的方法是使用 `git cherry-pick` 5次。但是有一个简单的方法，只需要pick两次

git 的 pick 可以指定范围，下面的代码告诉大家如何使用

```csharp
git cherry-pick 8793f59a87cbc4c62cf77b21369de657dc343a5d^...e50b523f12d34435b3b49fe229d76ecc4754687f

//8793f59a87cbc4c62cf77b21369de657dc343a5d 提交 0 

//e50b523f12d34435b3b49fe229d76ecc4754687f 提交 2

git cherry-pick 55b43be69fa90f4d03f27632c0231458ba1e7fd9...76a0298d38760a635f404c1660238ae852d96517

//55b43be69fa90f4d03f27632c0231458ba1e7fd9 错误的提交

//76a0298d38760a635f404c1660238ae852d96517 提交 4
```

可以看到第一个代码存在`^`，因为pick的范围是`(左开，右闭]`，所以为了包含 提交0 ，就需要在提交0添加`^`。第二个提交从 55b43be69fa90f4d03f27632c0231458ba1e7fd9 错误的提交 开始，因为左开右闭，不会包含这个提交。

## git 删除不需要的分支

```csharp
git branch --merged | grep -v 'dev' | xargs -n 1 git branch -d
```




可以删除已经合并的分支

## git 取消暂存

如果错误 add 不想添加的文件，可以使用下面命令取消添加文件

```csharp
git reset .
```

如果有 f1 f2 两个文件，错误把两个文件都使用 add 暂存，现在只需要添加 f1 那么可以使用下面代码

```csharp
git reset f2
```

使用方法：

```csharp
git reset 文件名
```

如果需要查看现在暂存的文件，可以使用下面代码

```csharp
git status
```


## git worktree 添加已有分支的空间

使用下面代码可以使用已有分支添加空间

```csharp
git worktree add <文件夹> 分支
```

## 在 VisualStudio 添加 Blame

在 VisualStudio ，我看到了自带的 Blame 很烂，于是如何在 VisualStudio 添加一个强大的 Blame？

我选择了[deepgit](http://www.syntevo.com/deepgit/tour) ，我把它安装在 C 盘，安装完成可以使用外部命令把他放在 VisualStudio，下面就是方法

1. 确定 deepgit 的路径，记为 path ，我这里的是`C:\Program Files (x86)\DeepGit\bin\deepgit.exe`

1. 打开 VisualStudio 工具 外部工具

1. 点击添加

1. 输入标题，标题可以随意写。命令就是 path 安装路径，参数写`$(ItemPath)`

![](http://7xqpl8.com1.z0.glb.clouddn.com/34fdad35-5dfe-a75b-2b4b-8c5e313038e2%2F2017101010119.jpg)

1. 点击添加或移除按钮 自定义

![](http://7xqpl8.com1.z0.glb.clouddn.com/34fdad35-5dfe-a75b-2b4b-8c5e313038e2%2F20171010101234.jpg)

1. 添加命令 这里选择工具的外部命令4，外部命令和添加命令所在有关，我这里添加的是第4个

## git 列出所有的 subtree

请使用下面代码列出

```csharp
git log | grep git-subtree-dir | tr -d ' ' | cut -d ":" -f2 | sort | uniq
```

## git 推送 subtree

可以使用下面的代码推送

```csharp
git subtree --prefix="路径" push origin dev 
```

## git tag 添加说明

如果对于一个分支的提交，需要添加tag而且给说明，如

```csharp
v1.1 添加游戏
```

那么可以使用下面的命令

```csharp
git tag v1.1 -m "添加游戏"
```

这样就会拿分支最后一次提交添加 tag 加上说明



## [如何删除错误提交的 git 大文件](http://lindexi.oschina.io/lindexi//post/%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4%E9%94%99%E8%AF%AF%E6%8F%90%E4%BA%A4%E7%9A%84-git-%E5%A4%A7%E6%96%87%E4%BB%B6.html )

## [git无法pull仓库refusing to merge unrelated histories](http://lindexi.oschina.io/lindexi//post/git%E6%97%A0%E6%B3%95pull%E4%BB%93%E5%BA%93refusing-to-merge-unrelated-histories.html )

## [git subtree pull 错误 Working tree has modifications](http://lindexi.oschina.io/lindexi//post/git-subtree-pull-%E9%94%99%E8%AF%AF-Working-tree-has-modifications.html )

## [git 提交添加 emoij 文字](http://lindexi.oschina.io/lindexi//post/git-%E6%8F%90%E4%BA%A4%E6%B7%BB%E5%8A%A0-emoij-%E6%96%87%E5%AD%97.html )

## [git cannot lock ref](http://lindexi.oschina.io/lindexi//post/git-cannot-lock-ref.html )

## [git 修改commit日期为之前的日期](http://lindexi.oschina.io/lindexi//post/git-%E4%BF%AE%E6%94%B9commit%E6%97%A5%E6%9C%9F%E4%B8%BA%E4%B9%8B%E5%89%8D%E7%9A%84%E6%97%A5%E6%9C%9F.html )

## [git镜像仓库](http://lindexi.oschina.io/lindexi//post/git%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93.html )

## [git 合并两个仓库](http://lindexi.oschina.io/lindexi//post/git-%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E4%BB%93%E5%BA%93.html )

## [git 分支改名](http://lindexi.oschina.io/lindexi//post/git-%E5%88%86%E6%94%AF%E6%94%B9%E5%90%8D.html )

## [git push 错误 hook declined](http://lindexi.oschina.io/lindexi//post/git-push-%E9%94%99%E8%AF%AF-hook-declined.html )



<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://licensebuttons.net/l/by-nc-sa/4.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议</a>进行许可。欢迎转载、使用、重新发布，但务必保留文章署名[林德熙](http://blog.csdn.net/lindexi_gd)(包含链接:http://blog.csdn.net/lindexi_gd )，不得用于商业目的，基于本文修改后的作品务必以相同的许可发布。如有任何疑问，请与我[联系](mailto:lindexi_gd@163.com)。